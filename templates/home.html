<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Un secreto Maki üíå</title>
<link rel="manifest" href="/static/manifest.json">
<link rel="icon" href="/static/images/icon.png">

<style>
body{
    margin:0;
    font-family:'Segoe UI', sans-serif;
    background: linear-gradient(135deg,#ff9a9e,#fad0c4);
    display:flex;
    justify-content:center;
    align-items:center;
    height:100vh;
    color:white;
    text-align:center;
    overflow:hidden;
}

.card{
    background:rgba(255,255,255,0.15);
    padding:30px;
    border-radius:20px;
    backdrop-filter:blur(10px);
    max-width:400px;
}

h2{margin-top:0;}

.display{
    font-size:28px;
    letter-spacing:8px;
    margin:15px 0;
}

.keypad{
    display:grid;
    grid-template-columns:repeat(3,70px);
    gap:10px;
    justify-content:center;
}

.key{
    padding:18px;
    border:none;
    border-radius:12px;
    font-size:18px;
    background:#ff4d6d;
    color:white;
    cursor:pointer;
}

.key:hover{background:#ff1e4d;}

#message{
    margin-top:20px;
    font-size:22px;
    opacity:0;
    transition:2s;
}

/* üéÜ fuegos artificiales */
.fire{
    position:absolute;
    width:6px;
    height:6px;
    border-radius:50%;
    animation:explode 1.5s forwards;
}

@keyframes explode{
    to{
        transform:translate(var(--x),var(--y));
        opacity:0;
    }
}
/* üì≤ Bot√≥n instalar PWA */
#installBtn{
    margin-bottom:15px;
    padding:12px 22px;
    border:none;
    border-radius:14px;
    font-size:16px;
    font-weight:600;
    color:white;
    cursor:pointer;

    background:linear-gradient(135deg,#ff4d6d,#ff1e4d);
    box-shadow:0 6px 20px rgba(0,0,0,0.25);

    backdrop-filter:blur(6px);
    transition:all 0.3s ease;
    animation:fadeInUp 0.6s ease;
}

/* ‚ù§Ô∏è Hover */
#installBtn:hover{
    transform:translateY(-3px) scale(1.03);
    box-shadow:0 10px 25px rgba(0,0,0,0.35);
}

/* üíï Click */
#installBtn:active{
    transform:scale(0.96);
}

/* ‚ú® Animaci√≥n de aparici√≥n */
@keyframes fadeInUp{
    from{
        opacity:0;
        transform:translateY(20px);
    }
    to{
        opacity:1;
        transform:translateY(0);
    }
}

/* üå∏ efecto latido rom√°ntico opcional */
#installBtn::after{
    content:"";
    position:absolute;
    inset:0;
    border-radius:14px;
    background:radial-gradient(circle,rgba(255,255,255,0.4),transparent);
    opacity:0;
    transition:opacity 0.4s;
}

#installBtn:hover::after{
    opacity:1;
}
.dot{
    display:inline-block;
    width:14px;
    height:14px;
    margin:0 6px;
    border-radius:50%;
    background:rgba(255,255,255,0.4);
    transition:0.3s;
}

/* üíñ punto activo */
.dot.active{
    background:#ff1e4d;
    box-shadow:0 0 10px #ff1e4d;
}
</style>
</head>

<body>
<div class="card" id="card">
<button id="installBtn" style="display:none;">üì≤ Instalar</button>
<h2>üíñ Acertijo para vos, Maki üíñ</h2>
<p id="riddle">
Tengo cuatro n√∫meros que guardan un secreto.<br>
No es una fecha, pero siempre est√° con vos.<br>
Si los recuerdas‚Ä¶ descubrir√°s mi coraz√≥n üíå
</p>

<div class="display" id="display">
  <span class="dot"></span>
  <span class="dot"></span>
  <span class="dot"></span>
  <span class="dot"></span>
</div>

<div class="keypad">
<button class="key" onclick="press(1)">1</button>
<button class="key" onclick="press(2)">2</button>
<button class="key" onclick="press(3)">3</button>
<button class="key" onclick="press(4)">4</button>
<button class="key" onclick="press(5)">5</button>
<button class="key" onclick="press(6)">6</button>
<button class="key" onclick="press(7)">7</button>
<button class="key" onclick="press(8)">8</button>
<button class="key" onclick="press(9)">9</button>
<button class="key" onclick="clearCode()">‚Üê</button>
<button class="key" onclick="press(0)">0</button>
<button class="key" onclick="check()">OK</button>
</div>

<div id="message"></div>
</div>

<script>
const correct="1428";
let code="";

const love = [
"Maki, desde que llegaste a mi vida todo cambi√≥ de una forma que nunca imagin√©. Haces que los d√≠as simples se vuelvan especiales, que los momentos peque√±os tengan un significado enorme y que mi coraz√≥n se sienta en paz. Me encanta tu forma de ser, tu sonrisa, tu mirada y todo lo que eres. Gracias por existir, por estar conmigo y por hacerme tan feliz. Quiero seguir creciendo a tu lado, cuidarte, apoyarte y construir un futuro juntos, paso a paso, con amor, paciencia y sue√±os compartidos. Porque si algo tengo claro, es que te elegir√≠a una y mil veces m√°s üíñ"
];

function press(n){
    if(code.length<4){
        code+=n;
        updateDisplay();
    }
}

function clearCode(){
    code=code.slice(0,-1);
    updateDisplay();
}

function updateDisplay(){
    const dots = document.querySelectorAll(".dot");

    dots.forEach((dot, i) => {
        if(i < code.length){
            dot.classList.add("active");
        }else{
            dot.classList.remove("active");
        }
    });
}

function randomLove(){
    return love[Math.floor(Math.random()*love.length)];
}

/* üéÜ fuegos artificiales */
function fireworks(){
    for(let i=0;i<120;i++){
        let p=document.createElement("div");
        p.className="fire";
        p.style.left=50+"vw";
        p.style.top=50+"vh";
        p.style.background=`hsl(${Math.random()*360},100%,60%)`;

        let x=(Math.random()-0.5)*400+"px";
        let y=(Math.random()-0.5)*400+"px";
        p.style.setProperty("--x",x);
        p.style.setProperty("--y",y);

        document.body.appendChild(p);
        setTimeout(()=>p.remove(),1500);
    }
}

function check(){
    if(code===correct){

        fireworks();

        /* desaparecer acertijo */
        document.getElementById("riddle").style.display="none";
        document.querySelector(".keypad").style.display="none";
        document.getElementById("display").style.display="none";

        let msg=document.getElementById("message");
        msg.innerHTML=randomLove();
        msg.style.opacity=1;

    }else{
        alert("Casi‚Ä¶ intenta recordar mejor üí≠üíï");
        code="";
        updateDisplay();
    }
}

if('serviceWorker' in navigator){
    navigator.serviceWorker.register('/sw.js');
}
let deferredPrompt;

const installBtn = document.getElementById("installBtn");

window.addEventListener("beforeinstallprompt", (e) => {
    e.preventDefault();
    deferredPrompt = e;

    // mostrar bot√≥n
    installBtn.style.display = "block";
});

installBtn.addEventListener("click", async () => {
    installBtn.style.display = "none";

    deferredPrompt.prompt();

    const { outcome } = await deferredPrompt.userChoice;
    console.log("Resultado:", outcome);

    deferredPrompt = null;
});
</script>
</body>
</html>